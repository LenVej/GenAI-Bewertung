<div class="result-container" *ngIf="!loading && result">
  <h2>ğŸ“Š Ergebnis: {{ result.examTitle }}</h2>

  <div class="meta">
    <p>ğŸ•’ Gestartet: {{ result.startedAt | date: 'short' }}</p>
    <p>âœ… Abgegeben: {{ result.submittedAt | date: 'short' }}</p>
    <p>ğŸ¯ Gesamtpunktzahl:
      <strong [ngClass]="{ 'high-score': result.scorePercent >= 70, 'low-score': result.scorePercent < 70 }">
        {{ result.scorePercent }}%
      </strong>
    </p>
  </div>

  <hr />

  <div *ngFor="let r of result.results" class="result-question">
    <h3>ğŸ§  {{ r.questionText }}</h3>

    <div class="answer-block">
      <p><strong>Deine Antwort:</strong>
        <ng-container *ngIf="r.answerChoices && r.selectedIndices?.length > 0; else freitext">
          {{ getSelectedAnswerTexts(r) }}
        </ng-container>
        <ng-template #freitext>
          {{ r.textAnswer || 'â€”' }}
        </ng-template>
      </p>
      <p *ngIf="r.feedback"><strong>ğŸ’¬ AI Feedback:</strong> {{ r.feedback }}</p>
      <p>
        <strong>Bewertung:</strong>
        <span [ngClass]="{ 'correct': r.isCorrect, 'incorrect': !r.isCorrect }">
          {{ r.isCorrect ? 'âœ… Richtig' : 'âŒ Falsch' }}
        </span>
        <span class="score">({{ r.score * 100 | number: '1.0-0' }}%)</span>
      </p>
    </div>
  </div>
</div>

<div *ngIf="loading">â³ Lade Ergebnis...</div>
