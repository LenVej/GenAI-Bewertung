<div class="profile-wrapper">
  <!-- Linke Spalte: Benutzerinfo -->
  <div class="profile-sidebar">
    <h2>ğŸ‘¤ Mein Profil</h2>

    <div *ngIf="error" class="error-message">{{ error }}</div>

    <div *ngIf="user" class="user-info">
      <p><strong>Benutzername:</strong> {{ user.username }}</p>
      <p><strong>Email:</strong> {{ user.email }}</p>
      <p><strong>Seit:</strong> {{ user.createdAt | date:'short' }}</p>

      <button class="btn logout-btn" (click)="logout()">ğŸ”“ Logout</button>
      <button class="btn delete-btn" (click)="deleteUser()">ğŸ—‘ï¸ Konto lÃ¶schen</button>
    </div>
  </div>

  <!-- Rechte Spalte: Inhalt mit Tabs -->
  <div class="profile-content">
    <nav class="tabs">
      <button [class.active]="tab === 'progress'" (click)="tab = 'progress'">ğŸ“ˆ Fortschritt</button>
      <button [class.active]="tab === 'settings'" (click)="tab = 'settings'">âš™ï¸ Einstellungen</button>
    </nav>

    <div *ngIf="tab === 'progress'" class="tab-content">
      <h3>Lernfortschritt</h3>
      <p>Beantwortete Fragen: {{ stats.questionsAnswered }}</p>
      <p>Richtige Antworten: {{ stats.correctAnswers }}</p>
      <p>Erfolg: {{ (stats.correctAnswers / stats.questionsAnswered * 100) | number:'1.0-0' }}%</p>

      <!-- ğŸ‘‡ Deine erstellten Fragen -->
      <div *ngIf="userQuestions.length > 0" class="user-questions">
        <h3>ğŸ“ Deine erstellten Fragen</h3>
        <div class="table-wrapper">
          <table class="styled-table enhanced">
            <thead>
            <tr>
              <th>ID</th>
              <th>Typ</th>
              <th>Thema</th>
              <th>Fragetext</th>
              <th>Erstellt</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let q of userQuestions">
              <td>{{ q.questionId }}</td>
              <td>{{ q.questionType }}</td>
              <td>{{ q.subject }}</td>
              <td class="truncate">{{ q.questionText }}</td>
              <td>{{ q.createdAt | date: 'short' }}</td>
              <td>
                <button class="btn small danger" (click)="deleteQuestion(q.questionId)">ğŸ—‘ï¸</button>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>


      <div *ngIf="userQuestions.length === 0" class="no-questions">
        <p>Du hast noch keine Fragen erstellt.</p>
      </div>
    </div>

    <div *ngIf="tab === 'settings'" class="tab-content">
      <h3>âš™ï¸ Einstellungen</h3>

      <div class="setting-group">
        <label for="lang">ğŸŒ Sprache auswÃ¤hlen</label>
        <select id="lang" #langSelect (change)="changeLanguage(langSelect.value)">
          <option value="de" [selected]="currentLang === 'de'">Deutsch</option>
          <option value="en" [selected]="currentLang === 'en'">English</option>
        </select>
      </div>

      <div class="setting-group">
        <label for="tolerance">âœï¸ Tippfehler-Toleranz</label>
        <select id="tolerance" [(ngModel)]="settings.tolerance">
          <option value="low">Niedrig</option>
          <option value="medium">Mittel</option>
          <option value="high">Hoch</option>
        </select>
      </div>

      <div class="setting-group">
        <label>ğŸ”  GroÃŸ-/Kleinschreibung beachten</label>
        <input type="checkbox" [(ngModel)]="settings.caseSensitive" />
      </div>

      <div class="setting-group">
        <label for="estTol">ğŸ“ SchÃ¤tztoleranz (%)</label>
        <input type="number" id="estTol" [(ngModel)]="settings.estimateTolerance" min="0" max="100" />
      </div>
    </div>
  </div>
</div>

<!-- BestÃ¤tigungs-Modal -->
<div class="modal-overlay" *ngIf="showConfirmModal">
  <div class="modal-box">
    <h3>{{ confirmMessage }}</h3>
    <div class="modal-actions">
      <button class="btn danger-btn" (click)="confirmAction()">Ja, lÃ¶schen</button>
      <button class="btn cancel-btn" (click)="cancelAction()">Abbrechen</button>
    </div>
  </div>
</div>
